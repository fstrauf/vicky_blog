---
import { getCollection } from 'astro:content';
import BaseHead from '../components/BaseHead.astro';
import Footer from '../components/Footer.astro';
import Header from '../components/Header.astro';
import { SITE_DESCRIPTION, SITE_TITLE } from '../consts';

const posts = (await getCollection('blog'))
	.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
	.slice(0, 3);

const recipes = (await getCollection('recipes'))
	.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
	.slice(0, 3);
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
	</head>
	<body>
		<div class="no-print">
			<Header />
		</div>
		<main>
			<header class="mb-10 space-y-3">
				<h1 class="text-3xl font-bold">{SITE_TITLE}</h1>
				<p class="text-base text-gray-700">{SITE_DESCRIPTION}</p>
				<p class="text-base">
					<a class="underline" href="/blog">Read posts</a> or{' '}
					<a class="underline" href="/recipes">browse recipes</a>.
				</p>
			</header>

			<section class="mb-10">
				<h2 class="text-xl font-semibold">Recent posts</h2>
				<ul class="mt-3 space-y-2">
					{posts.map((post) => (
						<li>
							<a class="underline" href={`/blog/${post.id}/`}>
								{post.data.title}
							</a>
						</li>
					))}
				</ul>
			</section>

			<section>
				<h2 class="text-xl font-semibold">Recent recipes</h2>
				<ul class="mt-3 space-y-2">
					{recipes.map((recipe) => (
						<li>
							<a class="underline" href={`/recipes/${recipe.id}/`}>
								{recipe.data.title}
							</a>
						</li>
					))}
				</ul>
			</section>
		</main>
		<div class="no-print">
			<Footer />
		</div>
	</body>
</html>
