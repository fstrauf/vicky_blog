---
import { getCollection } from 'astro:content';
import BaseHead from '../components/BaseHead.astro';
import Footer from '../components/Footer.astro';
import Header from '../components/Header.astro';
import FormattedDate from '../components/FormattedDate.astro';
import { SITE_DESCRIPTION, SITE_TITLE } from '../consts';

const recipes = (await getCollection('recipes'))
	.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
	.slice(0, 3);
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
	</head>
	<body class="bg-[#FDFBF7]">
		<div class="no-print">
			<Header />
		</div>
		<main class="max-w-6xl mx-auto px-4 py-12">
			{/* Hero Section */}
			<section class="text-center mb-20">
				<h1 class="font-serif text-5xl md:text-6xl font-bold text-[#2D2A26] mb-6">
					Welcome to <span class="text-[#D66D50]">{SITE_TITLE}</span>
				</h1>
				<p class="text-xl text-[#5C5855] max-w-2xl mx-auto leading-relaxed mb-8">
					{SITE_DESCRIPTION}
				</p>
				<div class="flex justify-center gap-4">
					<a href="/recipes" class="px-8 py-3 bg-[#D66D50] text-white hover:text-white rounded-full font-bold shadow-md hover:bg-[#c45d40] transition-colors">
						Browse Recipes
					</a>
					<a href="/about" class="px-8 py-3 bg-white text-[#5C5855] rounded-full font-bold shadow-sm border border-[#E8E4D9] hover:bg-gray-50 transition-colors">
						About Me
					</a>
				</div>
			</section>

			{/* Recent Recipes */}
			<section class="mb-20">
				<div class="flex items-center justify-between mb-8">
					<h2 class="font-serif text-3xl font-bold text-[#2D2A26]">Fresh from the Kitchen</h2>
					<a href="/recipes" class="text-[#D66D50] font-semibold hover:text-[#81B29A] transition-colors">View all ‚Üí</a>
				</div>
				
				<ul class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
					{recipes.map((recipe) => (
						<li class="bg-white rounded-2xl overflow-hidden shadow-sm hover:shadow-lg transition-all duration-300 transform hover:-translate-y-1 border border-[#E8E4D9]">
							<a class="block h-full flex flex-col" href={`/recipes/${recipe.id}/`}>
								<div class="aspect-[4/3] overflow-hidden bg-gray-100 relative">
									{recipe.data.coverImage ? (
										<img 
											src={recipe.data.coverImage.src} 
											alt={recipe.data.coverImage.alt || recipe.data.title}
											class="w-full h-full object-cover transition-transform duration-500 hover:scale-105"
											loading="lazy"
										/>
									) : (
										<div class="w-full h-full flex items-center justify-center text-gray-300 bg-[#FDFBF7]">
											<span class="text-4xl">üç≥</span>
										</div>
									)}
								</div>
								<div class="p-6 flex flex-col flex-grow">
									<div class="mb-2 text-xs font-bold tracking-wider text-[#81B29A] uppercase">
										{recipe.data.tags && recipe.data.tags[0] ? recipe.data.tags[0] : 'Recipe'}
									</div>
									<h2 class="font-serif text-2xl font-bold text-[#2D2A26] mb-3 leading-tight group-hover:text-[#D66D50] transition-colors">
										{recipe.data.title}
									</h2>
									<p class="text-[#5C5855] text-sm line-clamp-2 mb-4 flex-grow">
										{recipe.data.description}
									</p>
									<div class="pt-4 mt-auto border-t border-gray-100 flex items-center justify-between text-xs text-gray-500 font-medium">
										<FormattedDate date={recipe.data.pubDate} />
										<span class="text-[#D66D50]">Read Recipe &rarr;</span>
									</div>
								</div>
							</a>
						</li>
					))}
				</ul>
			</section>

		</main>
		<div class="no-print">
			<Footer />
		</div>
	</body>
</html>
